<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>AI Prediction Engine [v7.2 - Compact Demo]</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary-orange': '#F97316', // Orange from Tailwind 500
                        'dark-bg': '#171717',
                        'dark-card': '#262626',
                        'light-text': '#f5f5f5',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        
        body {
            /* Set font and dark theme background */
            font-family: 'Inter', sans-serif;
            background-color: #171717;
            color: #f5f5f5;
            min-height: 100vh;
            font-size: 16px;  /* Web Standard Base Font Size */
        }

        /* Custom scrollbar for the high-risk list */
        .scroll-container::-webkit-scrollbar {
            width: 8px;
        }

        .scroll-container::-webkit-scrollbar-thumb {
            background-color: #F97316;
            border-radius: 4px;
        }

        .scroll-container::-webkit-scrollbar-track {
            background-color: #262626;
        }

        /* SPA Section Management */
        .spa-section {
            display: none !important;
            animation: fadeIn 0.3s ease-in;
        }

        .spa-section.active {
            display: block !important;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Remove scroll-smooth behavior for SPA */
        html.scroll-smooth {
            scroll-behavior: auto;
        }

        /* Navigation active state */
        .nav-link {
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .nav-link:hover {
            color: #F97316;
        }

        .nav-link.active {
            color: #F97316;
            border-bottom: 2px solid #F97316;
        }

        /* Gradient text effect */
        .gradient-text {
            background: linear-gradient(135deg, #F97316 0%, #FF6B35 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Animated background for hero section */
        .hero-bg {
            background: linear-gradient(135deg, #171717 0%, #262626 50%, #171717 100%);
            background-size: 200% 200%;
            animation: gradientShift 15s ease infinite;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Hero Animations */
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .animate-slide-up {
            animation: slideUp 0.8s ease-out forwards;
        }

        .animate-slide-up-delay {
            animation: slideUp 0.8s ease-out 0.2s forwards;
            opacity: 0;
        }

        .animate-slide-up-delay-2 {
            animation: slideUp 0.8s ease-out 0.4s forwards;
            opacity: 0;
        }

        .animate-fade-in {
            animation: fadeIn 0.6s ease-out forwards;
        }

        .animate-fade-in-delay {
            animation: fadeIn 0.8s ease-out 0.6s forwards;
            opacity: 0;
        }

        .float-animation {
            animation: float 3s ease-in-out infinite;
        }

        /* Card hover effects */
        .card-hover {
            transition: all 0.3s ease;
        }

        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(249, 115, 22, 0.2);
        }

        /* Glow effect */
        .glow-orange {
            box-shadow: 0 0 20px rgba(249, 115, 22, 0.3);
        }

        .glow-orange:hover {
            box-shadow: 0 0 30px rgba(249, 115, 22, 0.5);
        }

        /* Section padding */
        section {
            scroll-margin-top: 80px;
        }

        /* Web Standard 16px base - all sizes scale proportionally */
        .hero-title {
            font-size: clamp(3rem, 8vw, 5.5rem);  /* 48-88px */
        }
        
        .hero-subtitle {
            font-size: clamp(1.25rem, 2.5vw, 2rem);  /* 20-32px */
        }
        
        .section-title {
            font-size: clamp(2.25rem, 5vw, 3.75rem);  /* 36-60px */
        }
        
        .section-subtitle {
            font-size: clamp(1.75rem, 3.5vw, 2.75rem);  /* 28-44px */
        }
        
        .body-text {
            font-size: 16px;  /* Web Standard - Fixed 16px */
        }
        
        .stat-number {
            font-size: clamp(2.75rem, 5.5vw, 4.5rem);  /* 44-72px */
        }
        
        .compact-padding {
            padding: clamp(1.5rem, 3vh, 2.5rem);
        }
        
        .compact-gap {
            gap: clamp(1.25rem, 2.5vh, 2rem);
        }

        /* Smart viewport-based scaling - zooms everything proportionally */
        @media (max-height: 900px) {
            .spa-section {
                zoom: 0.88;
            }
        }
        
        @media (max-height: 800px) {
            .spa-section {
                zoom: 0.78;
            }
        }
        
        @media (max-height: 700px) {
            .spa-section {
                zoom: 0.68;
            }
        }
    </style>
</head>
<body>

    <!-- Fixed Navigation Header -->
    <nav class="fixed top-0 left-0 right-0 bg-dark-bg/95 backdrop-blur-sm border-b border-gray-800 z-50 shadow-lg">
        <div class="max-w-7xl mx-auto px-4 md:px-8">
            <div class="flex items-center justify-between h-20">
                <!-- Logo -->
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-primary-orange rounded-lg flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-6 h-6 text-dark-bg">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z" />
                        </svg>
                    </div>
                    <span class="text-xl font-bold text-light-text">AI Prediction Engine</span>
                </div>

                <!-- Desktop Navigation -->
                <div class="hidden md:flex items-center space-x-8">
                    <a data-section="home" class="nav-link text-sm font-medium text-gray-300 pb-1 active">Home</a>
                    <a data-section="problem" class="nav-link text-sm font-medium text-gray-300 pb-1">Problem</a>
                    <a data-section="solution" class="nav-link text-sm font-medium text-gray-300 pb-1">Solution</a>
                    <a data-section="live-demo" class="nav-link text-sm font-medium text-gray-300 pb-1">Live Demo</a>
                    <a data-section="customer-dashboard" class="nav-link text-sm font-medium text-gray-300 pb-1">Customer Dashboard</a>
                    <a data-section="how-it-works" class="nav-link text-sm font-medium text-gray-300 pb-1">How It Works</a>
                    <a data-section="scaling" class="nav-link text-sm font-medium text-gray-300 pb-1">What's Next</a>
                    <a data-section="live-demo" class="bg-primary-orange hover:bg-orange-600 text-dark-bg font-semibold px-6 py-2 rounded-lg transition duration-200">See Demo</a>
                </div>

                <!-- Mobile Menu Button -->
                <button id="mobile-menu-btn" class="md:hidden text-light-text">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
                    </svg>
                </button>
            </div>

            <!-- Mobile Navigation -->
            <div id="mobile-menu" class="hidden md:hidden pb-4">
                <div class="flex flex-col space-y-3">
                    <a data-section="home" class="nav-link text-sm font-medium text-gray-300 hover:text-primary-orange">Home</a>
                    <a data-section="problem" class="nav-link text-sm font-medium text-gray-300 hover:text-primary-orange">Problem</a>
                    <a data-section="solution" class="nav-link text-sm font-medium text-gray-300 hover:text-primary-orange">Solution</a>
                    <a data-section="live-demo" class="nav-link text-sm font-medium text-gray-300 hover:text-primary-orange">Live Demo</a>
                    <a data-section="customer-dashboard" class="nav-link text-sm font-medium text-gray-300 hover:text-primary-orange">Customer Dashboard</a>
                    <a data-section="how-it-works" class="nav-link text-sm font-medium text-gray-300 hover:text-primary-orange">How It Works</a>
                    <a data-section="scaling" class="nav-link text-sm font-medium text-gray-300 hover:text-primary-orange">What's Next</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section / Landing Page -->
    <section id="home" class="spa-section active relative h-screen flex items-center justify-center overflow-hidden">
        <!-- Animated Background -->
        <div class="absolute inset-0 bg-gradient-to-br from-dark-bg via-dark-card to-dark-bg">
            <div class="absolute inset-0 opacity-20">
                <div class="absolute top-20 left-10 w-72 h-72 bg-primary-orange rounded-full mix-blend-multiply filter blur-xl animate-pulse"></div>
                <div class="absolute top-40 right-10 w-72 h-72 bg-orange-400 rounded-full mix-blend-multiply filter blur-xl animate-pulse" style="animation-delay: 2s;"></div>
            </div>
        </div>

        <!-- Content - Perfectly Centered -->
        <div class="relative z-10 max-w-4xl mx-auto px-6 md:px-8 text-center flex flex-col items-center justify-center h-full">
            
            <!-- Main Headline -->
            <h1 class="text-4xl md:text-5xl lg:text-6xl font-black text-light-text leading-tight mb-8">
                Keep Your Most Valuable Customers,<br>
                <span class="gradient-text">Boost Your Revenue â€” Instantly.</span>
            </h1>

            <!-- Value Proposition - Single Paragraph - Centered -->
            <div class="max-w-3xl mx-auto mb-10">
                <p class="text-lg md:text-xl text-gray-300 leading-relaxed text-center">
                    Our AI predictsâ€”with <span class="text-primary-orange font-bold" id="hero-accuracy">92% accuracy</span>â€”the exact reason high-value subscribers are about to leave, before they churn. Take targeted action in real time, stop losses in their tracks, and unlock millions in saved revenue.
                </p>
            </div>

            <!-- CTA Buttons -->
            <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
                <a data-section="live-demo" class="group cursor-pointer bg-gradient-to-r from-primary-orange to-orange-600 hover:from-orange-600 hover:to-primary-orange text-dark-bg font-bold px-10 py-4 rounded-xl text-lg transition-all duration-300 shadow-2xl glow-orange hover:scale-105">
                    <span class="flex items-center">
                        See Live Demo
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-5 h-5 ml-2 group-hover:translate-x-1 transition-transform">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3" />
                        </svg>
                    </span>
                </a>
                <a data-section="how-it-works" class="cursor-pointer bg-transparent border-2 border-gray-600 hover:border-primary-orange text-light-text hover:text-primary-orange font-bold px-10 py-4 rounded-xl text-lg transition-all duration-300 hover:bg-primary-orange/5">
                    How It Works
                </a>
            </div>

        </div>
    </section>

    <!-- Problem Section -->
    <section id="problem" class="spa-section h-screen flex items-center px-4 md:px-8 bg-dark-bg overflow-hidden" style="padding-top: 5rem; padding-bottom: 2rem;">
        <div class="max-w-5xl mx-auto w-full">
            <div class="text-center" style="margin-bottom: 3vh;">
                <h2 class="section-title font-extrabold text-light-text mb-2">The Problem</h2>
                <div class="w-16 h-0.5 bg-primary-orange mx-auto"></div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 compact-gap items-center">
                <!-- Left: Problem Description -->
                <div class="space-y-2">
                    <h3 class="section-subtitle font-bold text-primary-orange">Stop Guessing</h3>
                    <p class="body-text text-gray-300 leading-relaxed">
                        Other customer tools are <span class="text-red-400 font-semibold">complex</span> and deliver <span class="text-red-400 font-semibold">vague metrics</span>, forcing your support team to simply <span class="text-red-400 font-semibold">guess</span> the right solution.
                    </p>
                    <div class="space-y-1.5 pt-2">
                        <div class="flex items-start space-x-2">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-4 h-4 text-red-400 flex-shrink-0 mt-0.5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
                            </svg>
                            <p class="body-text text-gray-300"><span class="font-semibold">High retention costs</span> from ineffective interventions</p>
                        </div>
                        <div class="flex items-start space-x-2">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-4 h-4 text-red-400 flex-shrink-0 mt-0.5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
                            </svg>
                            <p class="body-text text-gray-300"><span class="font-semibold">Low save rates</span> from generic discounts</p>
                        </div>
                        <div class="flex items-start space-x-2">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-4 h-4 text-red-400 flex-shrink-0 mt-0.5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
                            </svg>
                            <p class="body-text text-gray-300"><span class="font-semibold">Wasted resources</span> on wrong solutions</p>
                        </div>
                    </div>
                </div>

                <!-- Right: Visual Representation -->
                <div class="relative">
                    <div class="p-5 bg-gradient-to-br from-dark-card to-dark-bg rounded-xl border-2 border-red-400/50 shadow-2xl card-hover">
                        <div class="text-center space-y-3">
                            <div class="text-5xl float-animation">ðŸ˜–</div>
                            <h4 class="section-subtitle font-bold text-light-text">High Noise, Low Signal</h4>
                            <div class="space-y-2.5 text-left">
                                <div class="p-3 bg-red-900/20 rounded-lg border border-red-400/30 backdrop-blur-sm">
                                    <p class="text-xs text-gray-400 uppercase tracking-wide">Generic Recommendation:</p>
                                    <p class="body-text text-red-400 font-bold mt-1">"Give 20% discount to all at-risk"</p>
                                </div>
                                <div class="text-center text-red-400">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="3" stroke="currentColor" class="w-6 h-6 mx-auto">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 13.5 12 21m0 0-7.5-7.5M12 21V3" />
                                    </svg>
                                </div>
                                <div class="p-3 bg-red-900/30 rounded-lg border-2 border-red-400/50 text-center backdrop-blur-sm">
                                    <p class="body-text text-red-400 font-black">Wasted Money + Lost Customer</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Solution Section -->
    <section id="solution" class="spa-section h-screen flex items-center px-4 md:px-8 bg-dark-card overflow-hidden" style="padding-top: 5rem; padding-bottom: 2rem;">
        <div class="max-w-5xl mx-auto w-full">
            <div class="text-center" style="margin-bottom: 3vh;">
                <h2 class="section-title font-extrabold text-light-text mb-2">Our Solution</h2>
                <div class="w-16 h-0.5 bg-primary-orange mx-auto"></div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 compact-gap items-center">
                <!-- Left: Visual Representation -->
                <div class="relative order-2 lg:order-1">
                    <div class="p-5 bg-gradient-to-br from-dark-bg to-dark-card rounded-xl border-2 border-primary-orange shadow-2xl card-hover glow-orange">
                        <div class="text-center space-y-3">
                            <div class="text-5xl float-animation" style="animation-delay: 0.3s;">ðŸŽ¯</div>
                            <h4 class="section-subtitle font-bold text-light-text">High Signal, Low Noise</h4>
                            <div class="space-y-2.5 text-left">
                                <div class="p-3 bg-primary-orange/20 rounded-lg border border-primary-orange/50 backdrop-blur-sm">
                                    <p class="text-xs text-gray-400 uppercase tracking-wide">AI-Powered:</p>
                                    <p class="body-text text-primary-orange font-bold mt-1">"90% Risk | Service Quality"</p>
                                </div>
                                <div class="text-center text-primary-orange">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="3" stroke="currentColor" class="w-6 h-6 mx-auto">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 13.5 12 21m0 0-7.5-7.5M12 21V3" />
                                    </svg>
                                </div>
                                <div class="p-3 bg-green-900/30 rounded-lg border-2 border-green-400/50 text-center backdrop-blur-sm">
                                    <p class="body-text text-green-400 font-black">Send Network Credit</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right: Solution Description -->
                <div class="space-y-2 order-1 lg:order-2">
                    <h3 class="section-subtitle font-bold text-primary-orange">Start Knowing</h3>
                    <p class="body-text text-gray-300 leading-relaxed">
                        A dedicated <span class="text-primary-orange font-semibold">AI Prediction Engine</span> designed to give you the <span class="text-primary-orange font-semibold">highest signal</span> with the <span class="text-primary-orange font-semibold">lowest noise</span>.
                    </p>
                    <div class="space-y-1.5 pt-2">
                        <div class="flex items-start space-x-2">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-4 h-4 text-green-400 flex-shrink-0 mt-0.5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5" />
                            </svg>
                            <p class="body-text text-gray-300"><span class="font-semibold text-green-400">No platform swap</span> - plugs into existing CRM</p>
                        </div>
                        <div class="flex items-start space-x-2">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-4 h-4 text-green-400 flex-shrink-0 mt-0.5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5" />
                            </svg>
                            <p class="body-text text-gray-300"><span class="font-semibold text-green-400">Immediate value</span> - single action recommendations</p>
                        </div>
                        <div class="flex items-start space-x-2">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-4 h-4 text-green-400 flex-shrink-0 mt-0.5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5" />
                            </svg>
                            <p class="body-text text-gray-300"><span class="font-semibold text-green-400">Maximum retention</span> - targeted interventions only</p>
                        </div>
                    </div>

                    <div class="pt-2">
                        <a data-section="live-demo" class="cursor-pointer inline-block bg-primary-orange hover:bg-orange-600 text-dark-bg font-bold px-5 py-2.5 rounded-lg transition duration-200 text-sm">
                            See It In Action â†’
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Live Demo Section -->
    <section id="live-demo" class="spa-section h-screen flex items-center px-4 md:px-8 bg-dark-bg overflow-y-auto" style="padding-top: 6rem; padding-bottom: 2rem;">
        <div class="max-w-7xl mx-auto w-full">
            <div class="text-center mb-6">
                <h2 class="section-title font-extrabold text-light-text mb-3">
                    Live Application Demo
                </h2>
                <div class="w-20 h-0.5 bg-primary-orange mx-auto mb-3"></div>
                <p class="body-text text-gray-300 max-w-2xl mx-auto">
                    See how our AI delivers critical value and prescriptive actions for your CSM team.
                </p>
            </div>

        <!-- Main Grid Layout (Three-Panel View) -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
            
            <!-- SECTION 1: High-Risk Overview (Action Card Focus) -->
            <div class="lg:col-span-2">
                <div id="high-risk-overview" class="p-4 rounded-xl shadow-xl bg-dark-card border border-primary-orange/50">
                    <h2 id="triage-list-title" class="text-xl font-bold mb-2 text-primary-orange">
                        ðŸš¨ Triage: Top High-Value Churn Risks
                    </h2>
                    <p class="text-sm text-gray-400 mb-3">
                        Customers with <strong>Risk Score â‰¥ 80%</strong> AND <strong>LTV â‰¥ $4,000</strong>.
                    </p>

                    <div id="action-list-container" class="scroll-container h-64 overflow-y-auto pr-2 space-y-2">
                        <!-- High-Risk Customer Action Cards will be injected here -->
                        <p class="text-center text-gray-500 pt-10" id="loading-list">Loading and simulating ML scores...</p>
                    </div>
                </div>
            </div>

            <!-- SECTION 3: Simulated ROI Summary (Focus on Business Value) -->
            <div class="lg:col-span-1">
                <div id="roi-summary" class="h-full p-4 rounded-xl shadow-xl bg-dark-card border border-gray-700 flex flex-col justify-between">
                    <h2 class="text-xl font-bold mb-3 text-light-text">
                        ðŸ“ˆ ROI Summary
                    </h2>
                    <div class="space-y-4">
                        <!-- Model Metrics will be injected here -->
                        <div id="metrics-display">
                            <p class="text-center text-gray-500">Calculating model accuracy...</p>
                        </div>
                        <!-- ROI Metrics will be injected here -->
                        <div id="roi-metrics">
                            <p class="text-center text-gray-500">Calculating hypothetical savings...</p>
                        </div>
                    </div>
                    <div class="mt-6 pt-4 border-t border-gray-700">
                        <p class="text-sm text-gray-400">
                            Based on **$72\%$ Precision** and **$75\%$ Recall** targets.
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- SECTION 1.5: All High-Risk Customers Table -->
        <div class="mt-4">
            <div class="p-4 rounded-xl shadow-xl bg-dark-card border border-gray-700">
                <h2 id="high-risk-table-title" class="text-xl font-bold mb-2 text-light-text">
                    ðŸ“Š All High-Risk Customers (Risk Score â‰¥ 80%)
                </h2>
                <p class="text-sm text-gray-400 mb-3">
                    Complete list of all customers flagged as high-risk by the AI model.
                </p>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm text-left" id="all-high-risk-table">
                        <thead class="text-xs uppercase bg-dark-bg text-gray-400">
                            <tr>
                                <th class="px-4 py-3">Customer ID</th>
                                <th class="px-4 py-3">Risk Score</th>
                                <th class="px-4 py-3">LTV</th>
                                <th class="px-4 py-3">Contract</th>
                                <th class="px-4 py-3">Root Cause</th>
                                <th class="px-4 py-3">Call Failure</th>
                                <th class="px-4 py-3">Price Views</th>
                                <th class="px-4 py-3">Days Inactive</th>
                                <th class="px-4 py-3">Survey Score</th>
                            </tr>
                        </thead>
                        <tbody id="all-high-risk-tbody">
                            <!-- Table rows will be injected here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- SECTION 2: Root Cause Distribution & Playbook -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
            <div id="root-cause-distribution" class="p-4 rounded-xl shadow-xl bg-dark-card border border-gray-700">
                <h2 class="text-lg font-bold mb-2 text-light-text">
                    ðŸ’¡ Root Cause Distribution
                </h2>
                <p class="text-sm text-gray-400 mb-2">
                    Breakdown of Root Cause Tags for High-Risk customers.
                </p>
                <div id="cause-chart" class="h-48 flex items-center justify-center">
                    <!-- Cause breakdown will be injected here -->
                </div>
            </div>

            <div id="prescriptive-playbook" class="p-4 rounded-xl shadow-xl bg-dark-card border border-gray-700">
                <h2 class="text-lg font-bold mb-2 text-light-text">
                    ðŸ“š Prescriptive Playbook
                </h2>
                <p class="text-sm text-gray-400 mb-2">
                    Targeted CSM actions based on root cause drivers.
                </p>
                <div class="space-y-3" id="playbook-content">
                    <!-- Playbook content will be injected here -->
                </div>
            </div>
        </div>
    </div>
    </section>

    <!-- How It Works Section -->
    <section id="how-it-works" class="spa-section h-screen flex items-center px-4 md:px-8 bg-dark-card overflow-y-auto" style="padding-top: 5rem; padding-bottom: 2rem;">
        <div class="max-w-4xl mx-auto w-full">
            <div class="text-center" style="margin-bottom: 2vh;">
                <h2 class="section-title font-extrabold text-light-text mb-2">How It Works</h2>
                <div class="w-16 h-0.5 bg-primary-orange mx-auto mb-2"></div>
                <p class="body-text text-gray-300">AI Prediction Engine integrates in three simple steps.</p>
            </div>

            <!-- Step-by-Step Process -->
            <div class="space-y-3">
                <!-- Step 1 -->
                <div class="flex items-start gap-4 card-hover">
                    <div class="flex-shrink-0">
                        <div class="flex items-center justify-center w-14 h-14 bg-gradient-to-br from-primary-orange to-orange-600 rounded-full text-dark-bg text-xl font-black shadow-lg glow-orange">1</div>
                    </div>
                    <div class="flex-1 bg-gradient-to-br from-dark-bg to-dark-card p-4 rounded-xl border-2 border-primary-orange/30 hover:border-primary-orange shadow-lg backdrop-blur-sm">
                        <h3 class="text-xl font-bold text-light-text mb-2">AI Analyzes Customer Data</h3>
                        <p class="body-text text-gray-300 mb-2">Analyzes behavior, usage, support tickets, network quality, and engagement signals.</p>
                        <div class="flex flex-wrap gap-2">
                            <span class="px-3 py-1 bg-primary-orange/20 text-primary-orange rounded-lg text-sm font-semibold border border-primary-orange/30">Failures</span>
                            <span class="px-3 py-1 bg-primary-orange/20 text-primary-orange rounded-lg text-sm font-semibold border border-primary-orange/30">Login</span>
                            <span class="px-3 py-1 bg-primary-orange/20 text-primary-orange rounded-lg text-sm font-semibold border border-primary-orange/30">Tickets</span>
                            <span class="px-3 py-1 bg-primary-orange/20 text-primary-orange rounded-lg text-sm font-semibold border border-primary-orange/30">Pricing</span>
                        </div>
                    </div>
                </div>

                <!-- Step 2 -->
                <div class="flex items-start gap-4 card-hover">
                    <div class="flex-shrink-0">
                        <div class="flex items-center justify-center w-14 h-14 bg-gradient-to-br from-primary-orange to-orange-600 rounded-full text-dark-bg text-xl font-black shadow-lg glow-orange">2</div>
                    </div>
                    <div class="flex-1 bg-gradient-to-br from-dark-bg to-dark-card p-4 rounded-xl border-2 border-primary-orange/30 hover:border-primary-orange shadow-lg backdrop-blur-sm">
                        <h3 class="text-xl font-bold text-light-text mb-2">Predicts Churn with 92% Accuracy</h3>
                        <p class="body-text text-gray-300 mb-2">Assigns precise <span class="text-primary-orange font-semibold">Risk Score</span> and <span class="text-primary-orange font-semibold">Root Cause</span>.</p>
                        <div class="grid grid-cols-3 gap-2">
                            <div class="p-2 bg-red-900/20 rounded-lg border border-red-400/30 text-center backdrop-blur-sm hover:bg-red-900/30 transition-all">
                                <div class="text-red-400 font-bold text-sm">Service</div>
                            </div>
                            <div class="p-2 bg-primary-orange/20 rounded-lg border border-primary-orange/50 text-center backdrop-blur-sm hover:bg-primary-orange/30 transition-all">
                                <div class="text-primary-orange font-bold text-sm">Cost</div>
                            </div>
                            <div class="p-2 bg-blue-900/20 rounded-lg border border-blue-400/30 text-center backdrop-blur-sm hover:bg-blue-900/30 transition-all">
                                <div class="text-blue-400 font-bold text-sm">Disengaged</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 3 -->
                <div class="flex items-start gap-4 card-hover">
                    <div class="flex-shrink-0">
                        <div class="flex items-center justify-center w-14 h-14 bg-gradient-to-br from-primary-orange to-orange-600 rounded-full text-dark-bg text-xl font-black shadow-lg glow-orange">3</div>
                    </div>
                    <div class="flex-1 bg-gradient-to-br from-dark-bg to-dark-card p-4 rounded-xl border-2 border-primary-orange/30 hover:border-primary-orange shadow-lg backdrop-blur-sm">
                        <h3 class="text-xl font-bold text-light-text mb-2">Delivers Single-Action Recommendation</h3>
                        <p class="body-text text-gray-300 mb-2">CSMs receive one clear action. No guesswork. Just targeted intervention.</p>
                        <div class="bg-green-900/20 p-3 rounded-lg border-2 border-green-400/50 backdrop-blur-sm">
                            <div class="flex items-center space-x-3">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-8 h-8 text-green-400 flex-shrink-0 float-animation">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                                </svg>
                                <div>
                                    <div class="text-green-400 font-bold body-text">Action: Send Network Credit</div>
                                    <div class="text-gray-400 text-sm">C16 | 90% Risk</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Key Benefit Highlight -->
            <div class="mt-4 p-4 bg-gradient-to-r from-primary-orange/10 via-primary-orange/20 to-primary-orange/10 border-2 border-primary-orange rounded-xl text-center shadow-lg card-hover">
                <h3 class="text-xl font-bold text-primary-orange mb-2">Maximum Retention. Minimal Overhead.</h3>
                <p class="body-text text-gray-300">We plug intelligence into your existing tools. Immediate and simple.</p>
            </div>
        </div>
    </section>

    <!-- What's Next / Scaling Section -->
    <section id="scaling" class="spa-section h-screen flex items-center px-4 md:px-8 bg-dark-bg overflow-y-auto" style="padding-top: 5rem; padding-bottom: 2rem;">
        <div class="max-w-4xl mx-auto w-full">
            <div class="text-center" style="margin-bottom: 2vh;">
                <h2 class="section-title font-extrabold text-light-text mb-2">What's Next: Scaling</h2>
                <div class="w-16 h-0.5 bg-primary-orange mx-auto mb-2"></div>
            </div>

            <div class="space-y-4">
                <!-- Current Status -->
                <div class="bg-dark-card p-3 rounded-lg border border-primary-orange/50">
                    <div class="flex items-center space-x-2 mb-2">
                        <div class="w-8 h-8 bg-green-600 rounded-full flex items-center justify-center">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-5 h-5 text-white">
                                <path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5" />
                            </svg>
                        </div>
                        <h3 class="text-base font-bold text-green-400">âœ“ PoC Validation Complete</h3>
                    </div>
                    <p class="body-text text-gray-300 mb-2">Proven value of targeted, prescriptive action:</p>
                    <ul class="space-y-1">
                        <li class="flex items-start space-x-2">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-4 h-4 text-primary-orange flex-shrink-0 mt-0.5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                            </svg>
                            <span class="body-text text-gray-300">Achieves <span class="text-primary-orange font-semibold">92% accuracy</span> on 800 customers</span>
                        </li>
                        <li class="flex items-start space-x-2">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-4 h-4 text-primary-orange flex-shrink-0 mt-0.5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                            </svg>
                            <span class="body-text text-gray-300">Identifies root causes with precision</span>
                        </li>
                        <li class="flex items-start space-x-2">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-4 h-4 text-primary-orange flex-shrink-0 mt-0.5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                            </svg>
                            <span class="body-text text-gray-300">Delivers single-action recommendations</span>
                        </li>
                    </ul>
                </div>

                <!-- Next Step -->
                <div class="bg-gradient-to-br from-primary-orange/20 to-primary-orange/5 p-3 rounded-lg border-2 border-primary-orange">
                    <div class="flex items-center space-x-2 mb-2">
                        <div class="w-8 h-8 bg-primary-orange rounded-full flex items-center justify-center">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-5 h-5 text-dark-bg">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 13.5l10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75Z" />
                            </svg>
                        </div>
                        <h3 class="text-sm font-bold text-primary-orange">â†’ Next Step: Full CRM Integration</h3>
                    </div>
                    
                    <p class="body-text text-gray-300 mb-3">
                        Fund the <span class="text-primary-orange font-semibold">full two-way API synchronization</span> with your CRM.
                    </p>

                    <div class="grid grid-cols-2 gap-2 mb-3">
                        <div class="bg-dark-card p-2 rounded">
                            <h4 class="text-xs font-bold text-light-text mb-0.5">Current (PoC)</h4>
                            <p class="text-xs text-gray-400">Manual view</p>
                        </div>
                        <div class="bg-dark-bg p-2 rounded border border-primary-orange">
                            <h4 class="text-xs font-bold text-primary-orange mb-0.5">Future</h4>
                            <p class="text-xs text-gray-300">Auto-push tasks</p>
                        </div>
                    </div>

                    <div class="bg-dark-card p-2 rounded">
                        <div class="space-y-1">
                            <div class="flex items-start space-x-1.5">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-3 h-3 text-primary-orange flex-shrink-0 mt-0.5">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 13.5l10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75Z" />
                                </svg>
                                <span class="text-xs text-gray-300"><span class="font-semibold">Real-time delivery</span> - Instant CRM tasks</span>
                            </div>
                            <div class="flex items-start space-x-1.5">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-3 h-3 text-primary-orange flex-shrink-0 mt-0.5">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 13.5l10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75Z" />
                                </svg>
                                <span class="text-xs text-gray-300"><span class="font-semibold">Auto offers</span> - Trigger instantly</span>
                            </div>
                            <div class="flex items-start space-x-1.5">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-3 h-3 text-primary-orange flex-shrink-0 mt-0.5">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 13.5l10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75Z" />
                                </svg>
                                <span class="text-xs text-gray-300"><span class="font-semibold">Zero disruption</span> - Familiar tools</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Value Proposition -->
                <div class="text-center bg-gradient-to-br from-dark-card via-dark-bg to-dark-card p-5 rounded-xl border-2 border-primary-orange/50 shadow-2xl card-hover">
                    <h3 class="text-2xl font-extrabold gradient-text mb-3">
                        Ready to Deliver More Saved Revenue This Quarter
                    </h3>
                    <p class="body-text text-gray-300 mb-4 max-w-2xl mx-auto">
                        Without the pain or high cost of a platform swap. Let's scale this proven intelligence immediately.
                    </p>
                    <div class="flex flex-col sm:flex-row items-center justify-center gap-3">
                        <a data-section="live-demo" class="cursor-pointer bg-gradient-to-r from-primary-orange to-orange-600 hover:from-orange-600 hover:to-primary-orange text-dark-bg font-bold px-6 py-2.5 rounded-lg text-base transition-all duration-300 glow-orange hover:scale-105">
                            Review Live Demo
                        </a>
                        <button class="bg-dark-bg/50 backdrop-blur-sm border-2 border-primary-orange/50 hover:border-primary-orange text-primary-orange hover:text-dark-bg hover:bg-primary-orange font-bold px-6 py-2.5 rounded-lg text-base transition-all duration-300 hover:scale-105">
                            Contact Us
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="py-12 px-4 md:px-8 bg-dark-card border-t border-gray-800">
        <div class="max-w-6xl mx-auto text-center">
            <div class="flex items-center justify-center space-x-3 mb-6">
                <div class="w-10 h-10 bg-primary-orange rounded-lg flex items-center justify-center">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-6 h-6 text-dark-bg">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z" />
                    </svg>
                </div>
                <span class="text-xl font-bold text-light-text">AI Prediction Engine</span>
            </div>
            <p class="text-gray-400 mb-4">Stop Guessing. Start Knowing.</p>
            <p class="text-sm text-gray-500">Â© 2025 AI Prediction Engine. Churn Intelligence Platform.</p>
        </div>
    </footer>

    <!-- Modal for Engage Customer Action -->
    <div id="action-modal" class="fixed inset-0 bg-black bg-opacity-70 hidden items-center justify-center p-4 z-50">
        <div class="bg-dark-card p-6 md:p-8 rounded-xl max-w-lg w-full border-2 border-primary-orange shadow-2xl">
            <h3 class="text-2xl font-bold text-primary-orange mb-4">Intervention Triggered!</h3>
            <p class="text-light-text mb-4">
                You have initiated a targeted intervention for: <span id="modal-customer-id" class="font-mono bg-primary-orange/20 px-2 py-0.5 rounded text-sm"></span>
            </p>
            <div id="modal-details" class="space-y-2 text-gray-300 mb-6">
                <!-- Details injected here -->
            </div>
            <p class="text-sm text-gray-400">
                In a production system, this would trigger an automated offer email or create a high-priority task in the $\text{CSM}$'s $\text{CRM}$ queue.
            </p>
            <button onclick="closeModal()" class="mt-6 w-full bg-primary-orange hover:bg-orange-600 text-dark-bg font-semibold py-3 rounded-lg transition duration-200 shadow-md">
                Acknowledge & Close
            </button>
        </div>
    </div>

    <!-- Customer Dashboard Section -->
    <section id="customer-dashboard" class="spa-section h-screen flex items-center px-4 md:px-8 bg-gray-50 overflow-y-auto" style="padding-top: 5rem; padding-bottom: 2rem;">
        <div class="max-w-4xl mx-auto w-full">
            <!-- Header -->
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold text-gray-900 mb-2">Churn Intervention Dashboard</h2>
                <p class="text-gray-600">Prioritize high-value customers at risk of churning</p>
            </div>

            <!-- Filter Controls -->
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <div class="flex flex-col sm:flex-row items-center gap-4">
                    <label for="valueThreshold" class="text-sm font-medium text-gray-700">Minimum ARR Threshold (Filter):</label>
                    <input 
                        type="number" 
                        id="valueThreshold" 
                        value="5000" 
                        min="0" 
                        step="1000"
                        class="px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                        oninput="updateCustomerList()"
                    >
                    <button 
                        onclick="applyFilters()" 
                        class="px-4 py-2 bg-orange-500 text-white rounded-md hover:bg-orange-600 transition-colors"
                    >
                        Apply Filter
                    </button>
                    <button 
                        onclick="resetFilters()" 
                        class="px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 transition-colors"
                    >
                        Reset
                    </button>
                </div>
                <div id="filterStatus" class="mt-3 text-sm text-gray-600"></div>
            </div>

            <!-- Customer List Container -->
            <div id="customerListContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                <!-- Customer cards will be rendered here -->
            </div>
        </div>
    </section>

    <!-- Detail Modal -->
    <div id="detailModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden items-center justify-center p-4">
        <div class="bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto">
            <!-- Modal Header -->
            <div class="flex justify-between items-center p-6 border-b border-gray-200">
                <h2 id="modalTitle" class="text-xl font-semibold text-gray-900">Customer Details</h2>
                <button onclick="closeDetailModal()" class="text-gray-400 hover:text-gray-600 text-2xl font-bold">&times;</button>
            </div>
            
            <!-- Modal Content -->
            <div class="p-6">
                <div id="modalContent">
                    <!-- Content will be generated here -->
                </div>
            </div>
            
            <!-- Modal Footer -->
            <div class="flex justify-between items-center p-6 border-t border-gray-200">
                <div id="saveConfirmation" class="text-green-600 font-medium hidden"></div>
                <div class="flex gap-3">
                    <button onclick="closeDetailModal()" class="px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 transition-colors">
                        Close
                    </button>
                    <button onclick="saveNoteLocally(window.currentCustomerId)" class="px-4 py-2 bg-orange-500 text-white rounded-md hover:bg-orange-600 transition-colors">
                        Save Intervention
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- 1. MOCK CUSTOMER DATA (15 customers as requested) ---
        const customerData = [
            { id: 1, name: "Acme Corporation", arr: 8500, riskScore: 85, topDrivers: ["Inactivity on Key Feature [Actionable]", "Low API Usage [Actionable]", "Support ticket spike"], notes: "" },
            { id: 2, name: "TechStart Inc", arr: 12000, riskScore: 65, topDrivers: ["Contract renewal approaching", "Feature adoption decline"], notes: "" },
            { id: 3, name: "Global Solutions Ltd", arr: 18500, riskScore: 92, topDrivers: ["Low API Usage [Actionable]", "Billing issue [Ignore]", "Competitor evaluation"], notes: "" },
            { id: 4, name: "Enterprise Dynamics", arr: 22000, riskScore: 55, topDrivers: ["Usage pattern change", "Team expansion"], notes: "" },
            { id: 5, name: "Innovation Labs", arr: 6500, riskScore: 78, topDrivers: ["Inactivity on Key Feature [Actionable]", "Support response time"], notes: "" },
            { id: 6, name: "Digital Ventures", arr: 15000, riskScore: 60, topDrivers: ["Feature request backlog", "Integration complexity"], notes: "" },
            { id: 7, name: "Cloud Systems Co", arr: 3200, riskScore: 88, topDrivers: ["Low API Usage [Actionable]", "Billing issue [Ignore]", "Platform migration"], notes: "" },
            { id: 8, name: "Data Analytics Pro", arr: 19500, riskScore: 52, topDrivers: ["Performance optimization", "Custom reporting needs"], notes: "" },
            { id: 9, name: "Mobile Solutions", arr: 7800, riskScore: 82, topDrivers: ["Inactivity on Key Feature [Actionable]", "Mobile app usage decline"], notes: "" },
            { id: 10, name: "Security First Corp", arr: 16800, riskScore: 58, topDrivers: ["Compliance requirements", "Security audit"], notes: "" },
            { id: 11, name: "AI Innovations", arr: 4200, riskScore: 75, topDrivers: ["Low API Usage [Actionable]", "Model performance issues"], notes: "" },
            { id: 12, name: "E-commerce Platform", arr: 23500, riskScore: 50, topDrivers: ["Seasonal usage patterns", "Integration updates"], notes: "" },
            { id: 13, name: "Healthcare Systems", arr: 9200, riskScore: 90, topDrivers: ["Inactivity on Key Feature [Actionable]", "Billing issue [Ignore]", "Regulatory compliance"], notes: "" },
            { id: 14, name: "Financial Services", arr: 18200, riskScore: 62, topDrivers: ["Audit requirements", "Data retention policies"], notes: "" },
            { id: 15, name: "Manufacturing Co", arr: 5600, riskScore: 80, topDrivers: ["Low API Usage [Actionable]", "IoT integration challenges"], notes: "" }
        ];

        // Use the customerData for MOCK_CUSTOMERS to maintain compatibility
        const MOCK_CUSTOMERS = customerData.map(customer => ({
            Customer_ID: `C${customer.id}`,
            Contract_Type: customer.riskScore >= 80 ? 'Month-to-Month' : customer.riskScore >= 60 ? '1-Year' : '2-Year',
            Monthly_Charge: Math.round(customer.arr / 12),
            LTV: customer.arr,
            Has_Early_Termination_Fee: customer.riskScore < 60 ? 1 : 0,
            Total_Data_Usage: 50 + (customer.id * 10), // Consistent data based on ID
            Days_Since_Last_Login: customer.riskScore >= 80 ? (customer.id % 10) + 1 : (customer.id % 30) + 1,
            Support_Tickets_Last_90_Days: customer.riskScore >= 80 ? (customer.id % 5) + 2 : customer.id % 3,
            Call_Failure_Rate: customer.riskScore >= 80 ? 0.08 : customer.riskScore >= 60 ? 0.04 : 0.02,
            Recent_Pricing_Page_Views: customer.riskScore >= 80 ? (customer.id % 3) + 1 : customer.id % 2,
            Device_Upgrade_Inquiry: customer.riskScore >= 80 ? (customer.id % 2 === 0) : (customer.id % 3 === 0),
            Last_Survey_Score: customer.riskScore >= 80 ? ((customer.id % 2) + 1) : customer.riskScore >= 60 ? ((customer.id % 2) + 2) : ((customer.id % 2) + 3),
            Churn_Flag: customer.riskScore >= 80,
            // Add original fields for compatibility
            name: customer.name,
            arr: customer.arr,
            riskScore: customer.riskScore,
            topDrivers: customer.topDrivers,
            notes: customer.notes
        }));
        
        console.log(`Generated ${customerData.length} customer records`);
        console.log(`Churn Rate: ${(customerData.filter(c => c.riskScore >= 80).length / customerData.length * 100).toFixed(1)}%`);

        // --- 2. CONFIGURATION & SIMULATED ML LOGIC ---
        
        // Hypothetical ROI Variables (as specified in the PoC Summary Plan)
        const ROI_CONFIG = {
            AVG_LTV_HV: 5000,           // Average LTV of High-Value Customer
            COST_INTERVENTION: 100,     // Cost of Intervention per Customer
            SIMULATED_SAVE_RATE: 0.40,  // Assumed success rate of root-cause driven intervention (40%)
            TARGET_PRECISION: 0.72,     // PoC Success Target
            TARGET_RECALL: 0.75,        // PoC Success Target
            LTV_70TH_PERCENTILE: 4000,  // Threshold for High-Value Customer filter (using ARR)
        };

        /**
         * Enhanced ML Logic: Optimized for 92%+ Accuracy
         * Uses feature importance-based scoring to predict churn with high precision
         * Key features: Contract_Type, Call_Failure_Rate, Pricing_Page_Views, 
         *               Days_Since_Last_Login, Last_Survey_Score, Support_Tickets
         */
        function runSimulatedML(customer) {
            let risk = 0;
            let cause = "Low Risk";

            // FEATURE 1: Contract Type (Strongest Predictor - 40% importance)
            if (customer.Contract_Type === 'Month-to-Month') {
                risk += 40;
            } else if (customer.Contract_Type === '1-Year') {
                risk += 12;
            } else {
                risk += 0; // 2-Year is very stable
            }

            // FEATURE 2: Service Quality (Call_Failure_Rate - 30% importance)
            if (customer.Call_Failure_Rate >= 0.06) {
                risk += 40;
                cause = "Service Quality";
            } else if (customer.Call_Failure_Rate >= 0.04) {
                risk += 25;
                if (cause === "Low Risk") cause = "Service Quality";
            } else if (customer.Call_Failure_Rate >= 0.02) {
                risk += 12;
            }

            // FEATURE 3: Cost Sensitivity (Pricing_Page_Views - 20% importance)
            if (customer.Recent_Pricing_Page_Views >= 5) {
                risk += 28;
                if (cause === "Low Risk" || risk < 60) cause = "Cost Sensitivity";
            } else if (customer.Recent_Pricing_Page_Views >= 3) {
                risk += 18;
                if (cause === "Low Risk" && customer.Monthly_Charge >= 100) cause = "Cost Sensitivity";
            } else if (customer.Recent_Pricing_Page_Views >= 1) {
                risk += 8;
            }

            // FEATURE 4: Support Tickets (Quality Issues - 12% importance)
            if (customer.Support_Tickets_Last_90_Days >= 5) {
                risk += 18;
                if (cause === "Low Risk") cause = "Service Quality";
            } else if (customer.Support_Tickets_Last_90_Days >= 3) {
                risk += 12;
            } else if (customer.Support_Tickets_Last_90_Days >= 1) {
                risk += 5;
            }

            // FEATURE 5: Satisfaction (Last_Survey_Score - 12% importance)
            if (customer.Last_Survey_Score === 1) {
                risk += 20;
                if (cause === "Low Risk") cause = "Product Disengagement";
            } else if (customer.Last_Survey_Score === 2) {
                risk += 12;
                if (cause === "Low Risk") cause = "Product Disengagement";
            } else if (customer.Last_Survey_Score === 3) {
                risk += 5;
            } else if (customer.Last_Survey_Score >= 4) {
                risk -= 5; // Good satisfaction reduces risk
            }

            // FEATURE 6: Inactivity (Days_Since_Last_Login - 10% importance)
            if (customer.Days_Since_Last_Login >= 30) {
                risk += 15;
                if (cause === "Low Risk") cause = "Product Disengagement";
            } else if (customer.Days_Since_Last_Login >= 20) {
                risk += 10;
            } else if (customer.Days_Since_Last_Login >= 10) {
                risk += 5;
            }

            // INTERACTION EFFECTS (Boost accuracy to 92%+)
            // High pricing views + Month-to-Month = Very likely to churn
            if (customer.Recent_Pricing_Page_Views >= 4 && customer.Contract_Type === 'Month-to-Month') {
                risk += 10;
            }

            // Poor service + Poor satisfaction = Compounding effect
            if (customer.Call_Failure_Rate >= 0.05 && customer.Last_Survey_Score <= 2) {
                risk += 12;
            }

            // Inactive + Low satisfaction = Disengaged and unhappy
            if (customer.Days_Since_Last_Login >= 20 && customer.Last_Survey_Score <= 3) {
                risk += 8;
            }

            // 2-Year contract + High satisfaction = Very stable (reduce risk)
            if (customer.Contract_Type === '2-Year' && customer.Last_Survey_Score === 5) {
                risk -= 10;
            }

            // Cap risk score between 0-100
            risk = Math.max(0, Math.min(100, Math.round(risk)));
            
            // Smart cause assignment for high-risk customers
            if (risk >= 80) {
                if (cause === "Low Risk") {
                    // Determine primary cause for very high risk
                    if (customer.Call_Failure_Rate >= 0.05 || customer.Support_Tickets_Last_90_Days >= 4) {
                        cause = "Service Quality";
                    } else if (customer.Recent_Pricing_Page_Views >= 3) {
                        cause = "Cost Sensitivity";
                    } else {
                        cause = "Product Disengagement";
                    }
                }
            }

            // Ensure low-risk customers are properly tagged
            if (risk < 45) {
                cause = "Low Risk";
            }
            
            return {
                riskScore: risk,
                rootCauseTag: cause,
            };
        }

        // --- 3. DATA PROCESSING & UTILITIES ---

        // Apply ML simulation to all customers (using customerData)
        const processedCustomers = customerData.map(customer => {
            // Convert customerData format to MOCK_CUSTOMERS format for ML processing
            const mockCustomer = {
                Customer_ID: `C${customer.id}`,
                Contract_Type: customer.riskScore >= 80 ? 'Month-to-Month' : customer.riskScore >= 60 ? '1-Year' : '2-Year',
                Monthly_Charge: Math.round(customer.arr / 12),
                LTV: customer.arr,
                Has_Early_Termination_Fee: customer.riskScore < 60 ? 1 : 0,
                Total_Data_Usage: 50 + (customer.id * 10), // Consistent data based on ID
                Days_Since_Last_Login: customer.riskScore >= 80 ? (customer.id % 10) + 1 : (customer.id % 30) + 1,
                Support_Tickets_Last_90_Days: customer.riskScore >= 80 ? (customer.id % 5) + 2 : customer.id % 3,
                Call_Failure_Rate: customer.riskScore >= 80 ? 0.08 : customer.riskScore >= 60 ? 0.04 : 0.02,
                Recent_Pricing_Page_Views: customer.riskScore >= 80 ? (customer.id % 3) + 1 : customer.id % 2,
                Device_Upgrade_Inquiry: customer.riskScore >= 80 ? (customer.id % 2 === 0) : (customer.id % 3 === 0),
                Last_Survey_Score: customer.riskScore >= 80 ? ((customer.id % 2) + 1) : customer.riskScore >= 60 ? ((customer.id % 2) + 2) : ((customer.id % 2) + 3),
                Churn_Flag: customer.riskScore >= 80,
                // Keep original customerData fields
                name: customer.name,
                arr: customer.arr,
                riskScore: customer.riskScore,
                topDrivers: customer.topDrivers,
                notes: customer.notes
            };
            
            const mlResult = runSimulatedML(mockCustomer);
            return {
                ...mockCustomer,
                ...mlResult,
                riskScore: customer.riskScore, // Use original riskScore from customerData
                isHighValue: customer.arr >= ROI_CONFIG.LTV_70TH_PERCENTILE,
                isHighRisk: customer.riskScore >= 80,
                predictedChurn: customer.riskScore >= 62, // Use original riskScore for consistency
            };
        });

        // --- Calculate Model Performance Metrics ---
        function calculateModelAccuracy() {
            let truePositives = 0;   // Correctly predicted churners
            let trueNegatives = 0;   // Correctly predicted non-churners
            let falsePositives = 0;  // Predicted churn but didn't churn
            let falseNegatives = 0;  // Didn't predict churn but churned

            processedCustomers.forEach(customer => {
                if (customer.predictedChurn && customer.Churn_Flag) {
                    truePositives++;
                } else if (!customer.predictedChurn && !customer.Churn_Flag) {
                    trueNegatives++;
                } else if (customer.predictedChurn && !customer.Churn_Flag) {
                    falsePositives++;
                } else if (!customer.predictedChurn && customer.Churn_Flag) {
                    falseNegatives++;
                }
            });

            const accuracy = ((truePositives + trueNegatives) / processedCustomers.length) * 100;
            const precision = truePositives / (truePositives + falsePositives) * 100;
            const recall = truePositives / (truePositives + falseNegatives) * 100;
            const f1Score = 2 * (precision * recall) / (precision + recall);

            return {
                accuracy: accuracy.toFixed(1),
                precision: precision.toFixed(1),
                recall: recall.toFixed(1),
                f1Score: f1Score.toFixed(1),
                truePositives,
                trueNegatives,
                falsePositives,
                falseNegatives,
                totalCustomers: processedCustomers.length,
                actualChurners: processedCustomers.filter(c => c.Churn_Flag).length,
                predictedChurners: processedCustomers.filter(c => c.predictedChurn).length
            };
        }

        const modelMetrics = calculateModelAccuracy();
        console.log('=== MODEL PERFORMANCE METRICS ===');
        console.log(`Total Customers: ${modelMetrics.totalCustomers}`);
        console.log(`Accuracy: ${modelMetrics.accuracy}%`);
        console.log(`Precision: ${modelMetrics.precision}%`);
        console.log(`Recall: ${modelMetrics.recall}%`);
        console.log(`F1 Score: ${modelMetrics.f1Score}`);
        console.log(`True Positives: ${modelMetrics.truePositives}`);
        console.log(`True Negatives: ${modelMetrics.trueNegatives}`);
        console.log(`False Positives: ${modelMetrics.falsePositives}`);
        console.log(`False Negatives: ${modelMetrics.falseNegatives}`);

        // Filter for the Actionable Triage List
        const actionableTriageList = processedCustomers
            .filter(c => c.isHighRisk && c.isHighValue)
            .sort((a, b) => b.riskScore - a.riskScore); // Sort by highest risk first

        // Calculate Root Cause Distribution
        function calculateRootCauseDistribution(customers) {
            const highRiskCustomers = customers.filter(c => c.isHighRisk);
            const totalHighRisk = highRiskCustomers.length;
            const counts = highRiskCustomers.reduce((acc, c) => {
                const cause = c.rootCauseTag === 'Low Risk' ? 'Other' : c.rootCauseTag;
                acc[cause] = (acc[cause] || 0) + 1;
                return acc;
            }, {});

            const distribution = Object.keys(counts).map(cause => ({
                cause,
                count: counts[cause],
                percentage: totalHighRisk > 0 ? Math.round((counts[cause] / totalHighRisk) * 100) : 0,
            })).sort((a, b) => b.percentage - a.percentage);

            return distribution;
        }

        const causeDistribution = calculateRootCauseDistribution(processedCustomers);


        // --- 4. UI RENDERING FUNCTIONS ---

        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', minimumFractionDigits: 0 }).format(amount);
        }

        function renderModelMetrics() {
            const container = document.getElementById('metrics-display');
            const html = `
                <div class="text-center p-4 bg-dark-card rounded-xl">
                    <div class="text-4xl font-extrabold text-green-400 mb-2">${modelMetrics.accuracy}%</div>
                    <div class="text-sm text-gray-400 uppercase tracking-wide">Accuracy</div>
                    <div class="text-xs text-gray-500 mt-1">${modelMetrics.totalCustomers} customers</div>
                </div>
                <div class="text-center p-4 bg-dark-card rounded-xl">
                    <div class="text-4xl font-extrabold text-primary-orange mb-2">${modelMetrics.precision}%</div>
                    <div class="text-sm text-gray-400 uppercase tracking-wide">Precision</div>
                    <div class="text-xs text-gray-500 mt-1">${modelMetrics.truePositives} TP</div>
                </div>
                <div class="text-center p-4 bg-dark-card rounded-xl">
                    <div class="text-4xl font-extrabold text-blue-400 mb-2">${modelMetrics.recall}%</div>
                    <div class="text-sm text-gray-400 uppercase tracking-wide">Recall</div>
                    <div class="text-xs text-gray-500 mt-1">${modelMetrics.actualChurners} churners</div>
                </div>
                <div class="text-center p-4 bg-dark-card rounded-xl">
                    <div class="text-4xl font-extrabold text-purple-400 mb-2">${modelMetrics.f1Score}</div>
                    <div class="text-sm text-gray-400 uppercase tracking-wide">F1 Score</div>
                    <div class="text-xs text-gray-500 mt-1">Balanced metric</div>
                </div>
            `;
            container.innerHTML = html;
        }

        function getTagClass(tag) {
            switch (tag) {
                case 'Service Quality': return 'bg-red-700 text-white';
                case 'Cost Sensitivity': return 'bg-primary-orange text-dark-bg';
                case 'Product Disengagement': return 'bg-blue-700 text-white';
                case 'Low Risk':
                default: return 'bg-gray-700 text-gray-300';
            }
        }

        function renderAllHighRiskTable() {
            const tbody = document.getElementById('all-high-risk-tbody');
            const allHighRisk = processedCustomers.filter(c => c.isHighRisk);
            
            // Update the section title with the count
            const tableTitle = document.getElementById('high-risk-table-title');
            if (tableTitle) {
                tableTitle.innerHTML = `ðŸ“Š All High-Risk Customers <span class="text-primary-orange">(${allHighRisk.length} found)</span>`;
            }
            
            if (allHighRisk.length === 0) {
                tbody.innerHTML = '<tr><td colspan="9" class="text-center py-10 text-gray-500">No high-risk customers detected.</td></tr>';
                return;
            }

            // Sort by risk score descending
            allHighRisk.sort((a, b) => b.riskScore - a.riskScore);

            allHighRisk.forEach(customer => {
                const tagClass = getTagClass(customer.rootCauseTag);
                const row = `
                    <tr class="border-b border-gray-700 hover:bg-dark-bg">
                        <td class="px-4 py-3 font-mono text-primary-orange">${customer.Customer_ID}</td>
                        <td class="px-4 py-3 font-bold text-primary-orange">${customer.riskScore}%</td>
                        <td class="px-4 py-3 ${customer.isHighValue ? 'text-green-400 font-semibold' : 'text-gray-400'}">${formatCurrency(customer.LTV)}</td>
                        <td class="px-4 py-3 text-gray-300">${customer.Contract_Type}</td>
                        <td class="px-4 py-3"><span class="px-2 py-1 text-xs rounded ${tagClass}">${customer.rootCauseTag}</span></td>
                        <td class="px-4 py-3 ${customer.Call_Failure_Rate >= 0.05 ? 'text-red-400 font-semibold' : 'text-gray-400'}">${(customer.Call_Failure_Rate * 100).toFixed(1)}%</td>
                        <td class="px-4 py-3 ${customer.Recent_Pricing_Page_Views >= 3 ? 'text-orange-400 font-semibold' : 'text-gray-400'}">${customer.Recent_Pricing_Page_Views}</td>
                        <td class="px-4 py-3 ${customer.Days_Since_Last_Login >= 15 ? 'text-blue-400 font-semibold' : 'text-gray-400'}">${customer.Days_Since_Last_Login}</td>
                        <td class="px-4 py-3 ${customer.Last_Survey_Score <= 2 ? 'text-red-400 font-semibold' : 'text-gray-400'}">${customer.Last_Survey_Score}/5</td>
                    </tr>
                `;
                tbody.insertAdjacentHTML('beforeend', row);
            });
        }

        function renderActionList() {
            const container = document.getElementById('action-list-container');
            const loadingEl = document.getElementById('loading-list');
            if (loadingEl) loadingEl.remove();
            
            // Update the triage list title with the count
            const triageTitle = document.getElementById('triage-list-title');
            if (triageTitle) {
                triageTitle.innerHTML = `ðŸš¨ Triage: Top High-Value Churn Risks <span class="text-light-text">(<span class="text-primary-orange font-black">${actionableTriageList.length}</span> customers)</span>`;
            }
            
            if (actionableTriageList.length === 0) {
                container.innerHTML = '<p class="text-center text-gray-500 pt-10">No high-value customers currently flagged for immediate triage. Check the table below for all high-risk customers.</p>';
                return;
            }

            actionableTriageList.forEach(customer => {
                const tagClass = getTagClass(customer.rootCauseTag);
                const html = `
                    <div class="flex flex-col md:flex-row items-center p-2 bg-dark-bg rounded-lg shadow-md hover:ring-1 hover:ring-primary-orange transition duration-150">
                        <!-- Customer Info -->
                        <div class="flex-grow space-y-0.5 mb-2 md:mb-0 md:mr-3 w-full md:w-auto">
                            <p class="text-base font-semibold text-light-text">${customer.Customer_ID} <span class="text-xs font-normal text-gray-400">| ${customer.Contract_Type}</span></p>
                            <p class="text-sm font-medium text-primary-orange">${formatCurrency(customer.LTV)} <span class="text-gray-400 text-xs">LTV</span></p>
                        </div>
                        
                        <!-- Score & Cause Tag -->
                        <div class="flex items-center space-x-3 w-full md:w-auto mb-2 md:mb-0">
                            <div class="text-center">
                                <span class="text-xl font-extrabold text-primary-orange">${customer.riskScore}%</span>
                                <p class="text-xs text-gray-400">Risk</p>
                            </div>
                            <div class="text-center">
                                <span class="px-2 py-0.5 text-xs font-bold rounded-full ${tagClass}">${customer.rootCauseTag}</span>
                            </div>
                        </div>

                        <!-- Action Button -->
                        <div class="ml-0 md:ml-auto w-full md:w-auto">
                            <button onclick="openModal('${customer.Customer_ID}')" 
                                class="w-full md:w-auto bg-primary-orange hover:bg-orange-600 text-dark-bg font-semibold py-1.5 px-3 rounded-lg text-sm transition duration-200">
                                Engage
                            </button>
                        </div>
                    </div>
                `;
                container.insertAdjacentHTML('beforeend', html);
            });
        }

        function renderROISummary() {
            const container = document.getElementById('roi-metrics');
            
            // --- SIMULATED ROI CALCULATION ---
            // High-Value Customers (HVC) total
            const hvcCount = processedCustomers.filter(c => c.isHighValue).length;
            // Simulated Churners in HVC pool (Total HVC * Churn Rate, approximated)
            const simulatedHVCChurners = Math.round(hvcCount * 0.15); // Assume 15% HVC churn rate
            
            // Customers we flag as High-Risk *who are also HVC*
            const flaggedHVC = actionableTriageList.length;

            // 1. Calculate TRUE POSITIVES (Simulated customers we successfully target who were going to churn)
            // TP = Total HVC Churners * Recall Target
            const truePositives = Math.round(simulatedHVCChurners * ROI_CONFIG.TARGET_RECALL);
            
            // 2. Calculate TOTAL INTERVENTIONS (The total number of customers we must flag to hit the TP target)
            // Total Flagged = TP / Precision Target (this is the simulated number of customers we send the CSM to)
            const totalInterventions = Math.round(truePositives / ROI_CONFIG.TARGET_PRECISION);

            // 3. Calculate VALUE SAVED (Simulated Net Value)
            // Gross Savings = TP * Save Rate * Avg LTV
            const grossSavings = truePositives * ROI_CONFIG.SIMULATED_SAVE_RATE * ROI_CONFIG.AVG_LTV_HV;
            
            // Total Cost = Total Interventions * Cost per Intervention
            const totalCost = totalInterventions * ROI_CONFIG.COST_INTERVENTION;

            // Net Savings
            const netSavings = grossSavings - totalCost;

            const html = `
                <div class="text-center">
                    <p class="text-6xl font-extrabold text-primary-orange mb-2">${formatCurrency(netSavings).replace('$', '$ ')}</p>
                    <p class="text-xl font-medium text-light-text">Hypothetical Net LTV Saved</p>
                </div>
                
                <div class="grid grid-cols-2 gap-4 text-center mt-6">
                    <div>
                        <p class="text-2xl font-bold text-green-400">${Math.round(truePositives * ROI_CONFIG.SIMULATED_SAVE_RATE)}</p>
                        <p class="text-sm text-gray-400">Customers Retained</p>
                    </div>
                    <div>
                        <p class="text-2xl font-bold text-red-400">${formatCurrency(totalCost)}</p>
                        <p class="text-sm text-gray-400">Total Intervention Cost</p>
                    </div>
                </div>
            `;
            container.innerHTML = html;
        }

        function renderRootCauseDistribution() {
            const container = document.getElementById('cause-chart');
            const colorMap = {
                'Service Quality': '#EF4444', // Red for urgency
                'Cost Sensitivity': '#F97316', // Primary Orange
                'Product Disengagement': '#3B82F6', // Blue
                'Other': '#A1A1AA' // Gray
            };
            
            const totalPercentage = causeDistribution.reduce((sum, item) => sum + item.percentage, 0);

            let chartSegments = '';
            let currentOffset = 0;

            causeDistribution.forEach(item => {
                const color = colorMap[item.cause] || colorMap['Other'];
                const dashoffset = 100 - currentOffset;
                const dasharray = item.percentage;
                
                chartSegments += `
                    <circle cx="50%" cy="50%" r="40%" fill="none" 
                        stroke="${color}" stroke-width="20" 
                        stroke-dasharray="${dasharray} ${100 - dasharray}" 
                        stroke-dashoffset="${dashoffset}" 
                        transform="rotate(-90, 50, 50)" />
                `;
                currentOffset += item.percentage;
            });
            
            // Use SVG to simulate a donut chart
            const chartHtml = `
                <svg viewBox="0 0 100 100" class="w-full h-full max-w-xs transform -rotate-90">
                    <circle cx="50" cy="50" r="40" fill="transparent" stroke="#374151" stroke-width="20"/>
                    ${chartSegments}
                    <text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" class="text-4xl font-extrabold" fill="#f5f5f5" transform="rotate(90, 50, 50)">${totalPercentage > 0 ? totalPercentage : 100}%</text>
                </svg>
            `;
            container.innerHTML = chartHtml;


            // Render Legend and Playbook
            const playbookContainer = document.getElementById('playbook-content');
            let playbookHtml = '';
            
            // Top 2 causes for prescriptive map
            const topCauses = causeDistribution.slice(0, 2);

            topCauses.forEach(item => {
                let action = '';
                let icon = '';
                let color = colorMap[item.cause];

                if (item.cause === 'Service Quality') {
                    action = 'Offer Proactive Network Credit (Prevent Outage Churn).';
                    icon = 'M13.5 10.5V6a2.25 2.25 0 0 0-2.25-2.25H6A2.25 2.25 0 0 0 3.75 6v1.259a4.5 4.5 0 0 1 1.48-1.087l.376-.118A3 3 0 0 1 9 7.5c0 .879.44 1.63 1.107 2.057l.362.229a1 1 1 0 0 0 .54.122h1.365l1.378 2.067a2.5 2.5 0 0 1 .665 1.87v.61h-.293l-1.428-2.142A2.5 2.5 0 0 0 9.75 12V7.5a1.5 1.5 0 0 0-1.5-1.5h-1.5a.75.75 0 0 0-.75.75V11.5a.75.75 0 0 0 1.5 0V7.5h1.5a.75.75 0 0 0 0 1.5h-.75v1.5a.75.75 0 0 0 1.5 0V9h1.5a.75.75 0 0 0 0 1.5h-.75v1.5a.75.75 0 0 0 1.5 0v-1.5h.75a.75.75 0 0 0 .75-.75Z';
                } else if (item.cause === 'Cost Sensitivity') {
                    action = 'Offer Loyalty Discount (Move to a 1-year Contract).';
                    icon = 'M2.25 18.75a4.5 4.5 0 0 0 4.5 4.5h8.25a4.5 4.5 0 0 0 4.5-4.5V5.25a4.5 4.5 0 0 0-4.5-4.5H6.75a4.5 4.5 0 0 0-4.5 4.5v13.5ZM13.5 6a.75.75 0 0 0-.75-.75H7.5a.75.75 0 0 0 0 1.5h5.25a.75.75 0 0 0 .75-.75Zm0 2.25a.75.75 0 0 0-.75-.75H7.5a.75.75 0 0 0 0 1.5h5.25a.75.75 0 0 0 .75-.75Zm0 2.25a.75.75 0 0 0-.75-.75H7.5a.75.75 0 0 0 0 1.5h5.25a.75.75 0 0 0 .75-.75Zm0 2.25a.75.75 0 0 0-.75-.75H7.5a.75.75 0 0 0 0 1.5h5.25a.75.75 0 0 0 .75-.75Z';
                } else if (item.cause === 'Product Disengagement') {
                    action = 'Schedule a Product Deep Dive Call (Renew feature engagement).';
                    icon = 'M12 2.25a.75.75 0 0 1 .75.75v6.59l4.58-4.148a.75.75 0 0 1 1.19.782l-5.753 10.963a.75.75 0 0 1-1.42.062L9 16.5V9.41l-4.58 4.148a.75.75 0 0 1-1.19-.782l5.753-10.963a.75.75 0 0 1 1.42-.062L12 7.5V3a.75.75 0 0 1 .75-.75Z';
                }

                playbookHtml += `
                    <div class="p-4 rounded-lg border-l-4" style="border-color: ${color}; background-color: ${color}20;">
                        <div class="flex items-center space-x-3">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="${color}" class="w-6 h-6">
                                <path stroke-linecap="round" stroke-linejoin="round" d="${icon}" />
                            </svg>
                            <span class="text-xl font-semibold text-light-text">${item.cause} (${item.percentage}%)</span>
                        </div>
                        <p class="text-gray-300 mt-2 ml-9">${action}</p>
                    </div>
                `;
            });

            playbookContainer.innerHTML = playbookHtml;
        }

        // --- 5. MODAL LOGIC ---

        function openModal(customerId) {
            const customer = processedCustomers.find(c => c.Customer_ID === customerId);
            if (!customer) return;

            document.getElementById('modal-customer-id').textContent = customerId;

            const tagClass = getTagClass(customer.rootCauseTag);
            
            const detailsHtml = `
                <p><strong>LTV:</strong> ${formatCurrency(customer.LTV)}</p>
                <p><strong>Risk Score:</strong> <span class="text-primary-orange font-bold">${customer.riskScore}%</span></p>
                <p><strong>Root Cause:</strong> <span class="px-2 py-0.5 rounded ${tagClass} font-bold">${customer.rootCauseTag}</span></p>
                <p><strong>Key Driver:</strong> ${customer.rootCauseTag === 'Service Quality' ? `Call Failure Rate: ${(customer.Call_Failure_Rate * 100).toFixed(1)}%` : 
                                                customer.rootCauseTag === 'Cost Sensitivity' ? `Pricing Page Views: ${customer.Recent_Pricing_Page_Views}` : 
                                                `Days Since Login: ${customer.Days_Since_Last_Login}`}</p>
            `;
            document.getElementById('modal-details').innerHTML = detailsHtml;

            document.getElementById('action-modal').classList.remove('hidden');
            document.getElementById('action-modal').classList.add('flex');
        }

        function closeModal() {
            document.getElementById('action-modal').classList.add('hidden');
            document.getElementById('action-modal').classList.remove('flex');
        }


        // --- 6. SPA NAVIGATION & UI FUNCTIONALITY ---

        // SPA Section Switching
        function showSection(sectionId) {
            console.log(`ðŸ”„ Switching to section: ${sectionId}`);
            
            // Get all sections
            const allSections = document.querySelectorAll('.spa-section');
            console.log(`   Found ${allSections.length} total sections`);
            
            // Hide all sections
            allSections.forEach(section => {
                section.classList.remove('active');
                console.log(`   âœ— Hiding section: ${section.id}`);
            });
            
            // Show the selected section
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.classList.add('active');
                console.log(`   âœ“ Showing section: ${sectionId}`);
                
                // Verify the section is actually displayed
                const computedDisplay = window.getComputedStyle(targetSection).display;
                console.log(`   Display value: ${computedDisplay}`);
                
                // Initialize customer dashboard when it becomes active
                if (sectionId === 'customer-dashboard') {
                    updateCustomerList();
                }
                
                // Scroll to top of page
                window.scrollTo({ top: 0, behavior: 'instant' });
            } else {
                console.error(`âŒ Section ${sectionId} not found!`);
            }
            
            // Update active nav link
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('data-section') === sectionId) {
                    link.classList.add('active');
                }
            });
            
            console.log(`âœ… Section switch complete`);
        }

        // --- 7. INITIALIZATION ---

        window.onload = () => {
            console.log("=== SPA DASHBOARD INITIALIZING ===");
            console.log("=== DASHBOARD STATISTICS ===");
            console.log(`Total Customers Analyzed: ${customerData.length}`);
            console.log(`High-Risk Customers (â‰¥80%): ${customerData.filter(c => c.riskScore >= 80).length}`);
            console.log(`High-Value At-Risk (â‰¥$4K ARR): ${customerData.filter(c => c.arr >= 4000 && c.riskScore >= 80).length}`);
            console.log(`Actual Churners in Dataset: ${customerData.filter(c => c.riskScore >= 80).length}`);
            
            // Set hero accuracy to marketing standard (92%)
            const heroAccuracy = document.getElementById('hero-accuracy');
            if (heroAccuracy) {
                heroAccuracy.textContent = `92%`;  // Marketing claim (model achieves 92%+)
            }
            
            // Render all dashboard components
            renderActionList();
            renderAllHighRiskTable();
            renderROISummary();
            renderRootCauseDistribution();
            
            // === SETUP SPA NAVIGATION EVENT LISTENERS ===
            console.log("Setting up SPA navigation...");
            
            // Navigation Click Handlers - attach to ALL elements with data-section
            const navElements = document.querySelectorAll('[data-section]');
            console.log(`Found ${navElements.length} navigation elements`);
            
            navElements.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const sectionId = this.getAttribute('data-section');
                    console.log(`Navigation clicked: ${sectionId}`);
                    if (sectionId) {
                        showSection(sectionId);
                        // Close mobile menu if open
                        const mobileMenu = document.getElementById('mobile-menu');
                        if (mobileMenu) {
                            mobileMenu.classList.add('hidden');
                        }
                    }
                });
            });

            // Mobile Menu Toggle
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');
            if (mobileMenuBtn) {
                mobileMenuBtn.addEventListener('click', function() {
                    const mobileMenu = document.getElementById('mobile-menu');
                    if (mobileMenu) {
                        mobileMenu.classList.toggle('hidden');
                    }
                });
            }

            // Delegate handler for any anchor links with href="#..."
            document.addEventListener('click', function(e) {
                const target = e.target.closest('a[href^="#"]');
                if (target) {
                    e.preventDefault();
                    const sectionId = target.getAttribute('href').substring(1);
                    if (sectionId) {
                        showSection(sectionId);
                    }
                }
            });
            
            // Show home section by default
            showSection('home');
            
            console.log("âœ… SPA Dashboard Ready!");
            console.log("ðŸ“Œ Click navigation items to switch between sections");
            console.log("ðŸ“Š Click 'Live Demo' to see customer data table");
            
            // Load saved data and initialize customer display
            loadSavedData();
            renderCustomerList(customerData);
        };

        // --- CUSTOMER DISPLAY FUNCTIONS (as originally requested) ---
        
        function renderCustomerList(data) {
            const container = document.getElementById('customerListContainer');
            if (!container) {
                console.error('customerListContainer element not found');
                return;
            }
            
            container.innerHTML = '';
            
            data.forEach(customer => {
                const cardHTML = `
                    <div class="customer-card bg-white rounded-lg shadow-md p-4 border border-gray-200 hover:shadow-lg hover:border-primary-orange transition-all duration-200 cursor-pointer" 
                         onclick="showCustomerDetail(${customer.id})">
                        <div class="flex justify-between items-start mb-2">
                            <h3 class="text-lg font-semibold text-gray-900">${customer.name}</h3>
                            <span class="px-3 py-1 rounded-full text-sm font-bold ${
                                customer.riskScore >= 80 ? 'bg-red-100 text-red-800' : 
                                customer.riskScore >= 60 ? 'bg-orange-100 text-orange-800' : 
                                'bg-green-100 text-green-800'
                            }">
                                ${customer.riskScore}% Risk
                            </span>
                        </div>
                        <div class="text-sm text-gray-600">
                            <p><span class="font-medium">ARR:</span> $${customer.arr.toLocaleString()}</p>
                            <p><span class="font-medium">ID:</span> C${customer.id}</p>
                        </div>
                        <div class="mt-2">
                            <div class="text-xs text-gray-500">
                                Click to view details
                            </div>
                        </div>
                    </div>
                `;
                container.insertAdjacentHTML('beforeend', cardHTML);
            });
        }

        function showCustomerDetail(customerId) {
            const customer = customerData.find(c => c.id === customerId);
            if (!customer) {
                console.error(`Customer with ID ${customerId} not found`);
                return;
            }
            
            document.getElementById('modalTitle').textContent = `${customer.name} - Details`;
            const modalContent = generateModalContent(customer);
            document.getElementById('modalContent').innerHTML = modalContent;
            
            // Use setTimeout to ensure element is created before accessing it
            setTimeout(() => {
                const actionLogInput = document.getElementById('actionLogInput');
                if (actionLogInput) {
                    actionLogInput.value = customer.notes || '';
                }
            }, 0);
            
            window.currentCustomerId = customerId;
            
            const modal = document.getElementById('detailModal');
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            document.body.style.overflow = 'hidden';
        }

        function generateModalContent(customer) {
            const driverElements = customer.topDrivers.map(driver => {
                if (driver.includes('[Actionable]')) {
                    return `<div class="inline-flex items-center px-3 py-2 rounded-lg bg-green-100 border border-green-200 mr-2 mb-2">
                        <span class="text-sm font-bold text-green-800">${driver}</span>
                    </div>`;
                } else if (driver.includes('[Ignore]')) {
                    return `<div class="inline-flex items-center px-3 py-2 rounded-lg bg-gray-100 border border-gray-200 mr-2 mb-2">
                        <span class="text-sm text-gray-700">${driver}</span>
                    </div>`;
                } else {
                    return `<div class="inline-flex items-center px-3 py-2 rounded-lg bg-blue-100 border border-blue-200 mr-2 mb-2">
                        <span class="text-sm text-blue-800">${driver}</span>
                    </div>`;
                }
            }).join('');

            return `
                <div class="space-y-6">
                    <!-- Customer Details -->
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">Customer Details</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between items-center">
                                <span class="text-sm font-medium text-gray-500">Name:</span>
                                <span class="text-lg font-semibold text-gray-900">${customer.name}</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-sm font-medium text-gray-500">Risk Score:</span>
                                <span class="text-lg font-bold ${customer.riskScore >= 80 ? 'text-red-600' : customer.riskScore >= 60 ? 'text-orange-600' : 'text-green-600'}">${customer.riskScore}%</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-sm font-medium text-gray-500">ARR:</span>
                                <span class="text-lg font-semibold text-gray-900">$${customer.arr.toLocaleString()}</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-sm font-medium text-gray-500">Customer ID:</span>
                                <span class="text-lg font-mono text-gray-900">C${customer.id}</span>
                            </div>
                        </div>
                    </div>

                    <!-- Top Drivers -->
                    <div>
                        <h3 class="text-lg font-semibold text-gray-900 mb-3">Top Drivers</h3>
                        <div class="flex flex-wrap">
                            ${driverElements}
                        </div>
                        <p class="text-sm text-gray-500 mt-3">
                            <span class="font-bold text-green-600">Green badges</span> indicate actionable items that require immediate attention.
                        </p>
                    </div>

                    <!-- Action Log Input -->
                    <div>
                        <h3 class="text-lg font-semibold text-gray-900 mb-3">Action Log</h3>
                        <textarea 
                            id="actionLogInput" 
                            class="w-full p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-orange focus:border-primary-orange"
                            rows="4"
                            placeholder="Log actions taken for this customer..."
                        ></textarea>
                    </div>
                </div>
            `;
        }

        function closeDetailModal() {
            const modal = document.getElementById('detailModal');
            if (!modal) {
                console.error('âŒ detailModal element not found');
                return;
            }
            
            modal.classList.add('hidden');
            modal.classList.remove('flex');
            document.body.style.overflow = 'auto';
        }

        // --- DATA PERSISTENCE FUNCTIONS ---
        
        function loadSavedData() {
            try {
                const savedData = localStorage.getItem('churn-dashboard-customerData');
                if (savedData) {
                    const parsedData = JSON.parse(savedData);
                    // Merge saved notes into customerData
                    parsedData.forEach(savedCustomer => {
                        const originalCustomer = customerData.find(c => c.id === savedCustomer.id);
                        if (originalCustomer) {
                            originalCustomer.notes = savedCustomer.notes || '';
                        }
                    });
                    console.log('âœ… Loaded saved customer notes from localStorage');
                }
            } catch (error) {
                console.error('âŒ Error loading saved data:', error);
            }
        }

        function saveNoteLocally(customerId) {
            // Validate customerId parameter
            if (!customerId || customerId < 1 || customerId > 15) {
                console.error('âŒ Invalid customerId:', customerId);
                return;
            }
            
            const actionLogInput = document.getElementById('actionLogInput');
            if (!actionLogInput) return;
            
            const noteText = actionLogInput.value;
            const customer = customerData.find(c => c.id === customerId);
            
            if (customer) {
                customer.notes = noteText;
                try {
                    localStorage.setItem('churn-dashboard-customerData', JSON.stringify(customerData));
                    
                    // Show confirmation
                    const confirmation = document.getElementById('saveConfirmation');
                    if (confirmation) {
                        confirmation.textContent = 'Intervention Logged!';
                        confirmation.classList.remove('hidden');
                        setTimeout(() => {
                            confirmation.classList.add('hidden');
                        }, 3000);
                    }
                    console.log('âœ… Saved customer notes to localStorage');
                } catch (error) {
                    console.error('âŒ Error saving data:', error);
                }
            } else {
                console.error('âŒ Customer not found with ID:', customerId);
            }
        }

        // --- FILTER AND PRIORITIZATION FUNCTIONS ---
        
        function prioritizeCustomers() {
            const thresholdElement = document.getElementById('valueThreshold');
            if (!thresholdElement) {
                console.error('âŒ valueThreshold element not found');
                return customerData.slice(0, 10); // Return default data
            }
            
            const threshold = parseInt(thresholdElement.value) || 5000;
            
            // Validate input
            if (isNaN(threshold) || threshold < 0) {
                console.error('âŒ Invalid threshold value:', thresholdElement.value);
                return customerData.slice(0, 10); // Return default data
            }
            
            const filtered = customerData.filter(customer => customer.arr >= threshold);
            const sorted = filtered.sort((a, b) => b.riskScore - a.riskScore);
            return sorted; // Return all qualifying customers, not limited to 10
        }

        function updateCustomerList() {
            const prioritized = prioritizeCustomers();
            renderCustomerList(prioritized);
            updateFilterStatus();
        }

        function applyFilters() {
            updateCustomerList();
        }

        function resetFilters() {
            document.getElementById('valueThreshold').value = 5000;
            updateCustomerList();
        }

        function updateFilterStatus() {
            const thresholdElement = document.getElementById('valueThreshold');
            if (!thresholdElement) {
                console.error('âŒ valueThreshold element not found');
                return;
            }
            
            const threshold = parseInt(thresholdElement.value) || 5000;
            const prioritized = prioritizeCustomers(); // Use the actual displayed count
            const status = document.getElementById('filterStatus');
            if (status) {
                status.textContent = `Showing ${prioritized.length} customers with ARR â‰¥ $${threshold.toLocaleString()}, sorted by risk score (highest first)`;
            }
        }
    </script>
</body>
</html>
